# Spread it!

A simple way to export your JavaScript objects into one of the following spreadsheet file formats: `.xlsx`, `Google Sheets`, `.csv (Not implemented yet)`

`npm install spread-it`

## Usage

Create the spreadshet object first:

```
import { getExcel } from 'spread-it'

const data = [{ myData: true }, 'second row']
const excel = await getExcel(data)
```

Then export it to your preferred format:

```
await excel.file('output.xlsx')
const buffer = await excel.buffer()
```

### Google Sheets
Google Sheets API is being accessed through service account credentials generated by Google. See ["Authentication" section in docs](https://theoephraim.github.io/node-google-spreadsheet/#/guides/authentication?id=service-account) for more info on how to make one.

It's required to use an existing Google spreadsheet with write rights granted to the service account email, as document created with a service account may not be accessible to your Google account. `spreadsheetId` is the long ID in the sheets URL.

## API
### Excel
#### `const excel = getExcel(data, settings?)`

creates the Excel document handler closure.

#### `excel.file(fileName: string): Promise<void>`

writes an .xlsx file.

#### `excel.buffer(): Promise<Buffer>: Promise<void>`

gets an .xlsx document buffer

#### `settings` object

```
{
	sheetName?: string - name of the created sheet
	setHeader?: boolean - displays the header values (false by default)
}
```

### Google Sheets
####  `const gsheets = getGoogleSheets(data, settings)`

creates the Google Sheets document handler closure.

#### `gsheets.upload(): Promise<void>`

uploads the Google Sheets document.

#### `settings` object
```
{
	spreadsheetId: string - required, the spreadsheet ID to write to
	credentials: {
		serviceAccountEmail: string - required, service account email
		privateKey: string - required, service account private key
	},
	sheetName?: string - name of the created sheet
	shrink?: boolean - shrinks the spreadsheet to data size (false by default)
}
```

### CSV

WIP
